[ { "type": "namespace", "name": "My\\Mongo", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 3, "char": 5 }, { "type": "class", "name": "Client", "abstract": 0, "final": 0, "definition": { "methods": [ { "visibility": [ "public", "static" ], "type": "method", "name": "init", "parameters": [ { "type": "parameter", "name": "servers", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 8, "char": 44 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 8, "char": 66 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 8, "char": 66 } ], "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "variable", "value": "servers", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 9, "char": 20 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 9, "char": 20 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "请设定正确的服务器地址", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 10, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 10, "char": 60 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 10, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 11, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 13, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "servers", "expr": { "type": "fcall", "name": "shuffle", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "servers", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 13, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 13, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 13, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 13, "char": 39 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 14, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 14, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 14, "char": 25 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 15, "char": 14 }, { "type": "declare", "data-type": "string", "variables": [ { "variable": "dnsString", "expr": { "type": "string", "value": "", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 15, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 15, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "dnsString", "expr": { "type": "cast", "left": "string", "right": { "type": "fcall", "name": "join", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": ",", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 43 }, { "parameter": { "type": "variable", "value": "servers", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 16, "char": 53 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 18, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "connect", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 18, "char": 20 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 19, "char": 10 }, { "type": "if", "expr": { "type": "fcall", "name": "class_exists", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": "\\MongoClient", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 19, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 19, "char": 39 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 19, "char": 41 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "connect", "expr": { "type": "new", "class": "\\MongoClient", "dynamic": 0, "parameters": [ { "parameter": { "type": "concat", "left": { "type": "string", "value": "mongodb:\/\/", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 56 }, "right": { "type": "variable", "value": "dnsString", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 66 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 66 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 66 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 75 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 20, "char": 76 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 21, "char": 18 }, { "type": "declare", "data-type": "string", "variables": [ { "variable": "readPreference", "expr": { "type": "string", "value": "", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 21, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 21, "char": 39 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 22, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "readPreference", "expr": { "type": "static-constant-access", "left": { "type": "variable", "value": "\\MongoClient", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 22, "char": 68 }, "right": { "type": "variable", "value": "RP_PRIMARY_PREFERRED", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 22, "char": 68 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 22, "char": 68 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 22, "char": 68 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 23, "char": 14 }, { "type": "if", "expr": { "type": "instanceof", "left": { "type": "variable", "value": "connect", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 23, "char": 33 }, "right": { "type": "variable", "value": "\\MongoClient", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 23, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 23, "char": 48 }, "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "connect", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 25, "char": 25 }, "name": "setReadPreference", "call-type": 3, "parameters": [ { "parameter": { "type": "variable", "value": "readPreference", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 25, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 25, "char": 62 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 25, "char": 63 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 26, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 27, "char": 9 } ], "else_statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "请安装PHP的Mongo1.4+版本的扩展", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 28, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 28, "char": 75 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 28, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 29, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 31, "char": 14 }, { "type": "return", "expr": { "type": "variable", "value": "connect", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 31, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 32, "char": 2 } ], "docblock": "**\r\n\t * servers = array(\"127.0.0.1:57017\",\"127.0.0.1:27017\");\r\n\t *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 8, "char": 23 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 3, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/client.zep", "line": 3, "char": 5 } ]
