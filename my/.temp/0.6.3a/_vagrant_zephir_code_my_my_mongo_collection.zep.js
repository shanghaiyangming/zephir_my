[ { "type": "namespace", "name": "My\\Mongo", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 3, "char": 5 }, { "type": "class", "name": "Collection", "abstract": 0, "final": 0, "definition": { "properties": [ { "visibility": [ "private" ], "type": "property", "name": "_client", "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 5, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 8, "char": 8 }, { "visibility": [ "private" ], "type": "property", "name": "_collection", "shortcuts": [ { "type": "shortcut", "name": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 9, "char": 6 }, { "type": "shortcut", "name": "get", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 10, "char": 2 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 12, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_collectionName", "shortcuts": [ { "type": "shortcut", "name": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 13, "char": 9 }, { "type": "shortcut", "name": "get", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 14, "char": 5 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 16, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_databaseName", "default": { "type": "string", "value": "ICCv1", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 16, "char": 37 }, "shortcuts": [ { "type": "shortcut", "name": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 17, "char": 9 }, { "type": "shortcut", "name": "get", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 18, "char": 5 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 20, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_clusterName", "default": { "type": "string", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 20, "char": 45 }, "shortcuts": [ { "type": "shortcut", "name": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 21, "char": 9 }, { "type": "shortcut", "name": "get", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 22, "char": 5 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 24, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_collectionOptions", "default": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 24, "char": 37 }, "shortcuts": [ { "type": "shortcut", "name": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 25, "char": 9 }, { "type": "shortcut", "name": "get", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 26, "char": 5 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 28, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_db", "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 28, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 30, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_admin", "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 30, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 32, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_backup", "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 32, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 34, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_mapreduce", "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 34, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 36, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_fs", "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 36, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 38, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_queryHaystack", "default": { "type": "array", "left": [ { "value": { "type": "string", "value": "and", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 39, "char": 8 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 39, "char": 8 }, { "value": { "type": "string", "value": "or", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 40, "char": 7 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 40, "char": 7 }, { "value": { "type": "string", "value": "nor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 41, "char": 8 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 41, "char": 8 }, { "value": { "type": "string", "value": "not", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 42, "char": 8 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 42, "char": 8 }, { "value": { "type": "string", "value": "where", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 44, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 44, "char": 2 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 44, "char": 3 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 46, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_updateHaystack", "default": { "type": "array", "left": [ { "value": { "type": "string", "value": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 47, "char": 11 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 47, "char": 11 }, { "value": { "type": "string", "value": "inc", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 48, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 48, "char": 14 }, { "value": { "type": "string", "value": "unset", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 49, "char": 16 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 49, "char": 16 }, { "value": { "type": "string", "value": "rename", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 50, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 50, "char": 17 }, { "value": { "type": "string", "value": "setOnInsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 51, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 51, "char": 22 }, { "value": { "type": "string", "value": "addToSet", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 52, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 52, "char": 19 }, { "value": { "type": "string", "value": "pop", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 53, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 53, "char": 14 }, { "value": { "type": "string", "value": "pullAll", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 54, "char": 18 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 54, "char": 18 }, { "value": { "type": "string", "value": "pull", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 55, "char": 15 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 55, "char": 15 }, { "value": { "type": "string", "value": "pushAll", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 56, "char": 18 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 56, "char": 18 }, { "value": { "type": "string", "value": "push", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 57, "char": 15 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 57, "char": 15 }, { "value": { "type": "string", "value": "each", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 58, "char": 15 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 58, "char": 15 }, { "value": { "type": "string", "value": "slice", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 59, "char": 16 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 59, "char": 16 }, { "value": { "type": "string", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 60, "char": 15 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 60, "char": 15 }, { "value": { "type": "string", "value": "bit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 61, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 61, "char": 14 }, { "value": { "type": "string", "value": "isolated", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 63, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 63, "char": 5 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 63, "char": 6 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 65, "char": 11 }, { "visibility": [ "private" ], "type": "property", "name": "_noAppendQuery", "default": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 65, "char": 36 }, "shortcuts": [ { "type": "shortcut", "name": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 66, "char": 9 }, { "type": "shortcut", "name": "get", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 67, "char": 5 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 69, "char": 9 } ], "methods": [ { "visibility": [ "public" ], "type": "method", "name": "__construct", "parameters": [ { "type": "parameter", "name": "collectionName", "const": 0, "data-type": "string", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 52 }, { "type": "parameter", "name": "databaseName", "const": 0, "data-type": "string", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 81 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 81 }, { "type": "parameter", "name": "clusterName", "const": 0, "data-type": "string", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 109 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 109 }, { "type": "parameter", "name": "collectionOptions", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 142 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 142 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_collectionName", "expr": { "type": "variable", "value": "collectionName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 87, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 87, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 88, "char": 5 }, { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_databaseName", "expr": { "type": "ternary", "left": { "type": "empty", "left": { "type": "variable", "value": "databaseName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 88, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 88, "char": 48 }, "right": { "type": "string", "value": "ICCv1", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 88, "char": 58 }, "extra": { "type": "variable", "value": "databaseName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 88, "char": 72 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 88, "char": 72 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 88, "char": 72 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 89, "char": 5 }, { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_clusterName", "expr": { "type": "ternary", "left": { "type": "empty", "left": { "type": "variable", "value": "clusterName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 89, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 89, "char": 46 }, "right": { "type": "string", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 89, "char": 65 }, "extra": { "type": "variable", "value": "clusterName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 89, "char": 78 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 89, "char": 78 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 89, "char": 78 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 90, "char": 5 }, { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_collectionOptions", "expr": { "type": "ternary", "left": { "type": "empty", "left": { "type": "variable", "value": "collectionOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 90, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 90, "char": 58 }, "right": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 90, "char": 63 }, "extra": { "type": "variable", "value": "collectionOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 90, "char": 82 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 90, "char": 82 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 90, "char": 82 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 91, "char": 2 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 16 }, { "visibility": [ "public" ], "type": "method", "name": "setMongoClient", "parameters": [ { "type": "parameter", "name": "client", "const": 0, "data-type": "variable", "mandatory": 0, "cast": { "type": "variable", "value": "\\MongoClient", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 93, "char": 53 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 93, "char": 54 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_client", "expr": { "type": "variable", "value": "client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 95, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 95, "char": 29 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 96, "char": 6 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 96, "char": 8 }, "name": "initDB", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 96, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 97, "char": 8 }, { "type": "return", "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 97, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 98, "char": 2 } ], "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "data-type": "bool", "mandatory": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 94, "char": 2 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 94, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 93, "char": 16 }, { "visibility": [ "public" ], "type": "method", "name": "getMongoClient", "statements": [ { "type": "return", "expr": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 102, "char": 15 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 102, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 102, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 103, "char": 2 } ], "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "cast": { "type": "variable", "value": "\\MongoClient", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 101, "char": 2 }, "collection": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 101, "char": 2 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 101, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 100, "char": 16 }, { "visibility": [ "private" ], "type": "method", "name": "initCollection", "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 107, "char": 8 }, "name": "initDB", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 107, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 5 }, { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_collection", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 32 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 41 }, "name": "selectCollection", "call-type": 1, "parameters": [ { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 64 }, "right": { "type": "variable", "value": "_databaseName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 78 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 78 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 78 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 84 }, "right": { "type": "variable", "value": "_collectionName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 100 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 100 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 100 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 101 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 108, "char": 101 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 109, "char": 8 }, { "type": "return", "expr": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 109, "char": 15 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 109, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 109, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 110, "char": 2 } ], "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "cast": { "type": "variable", "value": "\\MongoCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 106, "char": 2 }, "collection": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 106, "char": 2 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 106, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 105, "char": 17 }, { "visibility": [ "private" ], "type": "method", "name": "initDB", "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 114, "char": 17 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 114, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 114, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 114, "char": 27 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "please invoke method setMongoClient before initDB", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 115, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 115, "char": 76 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 115, "char": 77 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 116, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 5 }, { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_db", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 24 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 33 }, "name": "selectDB", "call-type": 1, "parameters": [ { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 48 }, "right": { "type": "variable", "value": "_databaseName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 62 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 63 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 117, "char": 63 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 118, "char": 2 } ], "return-type": { "type": "return-type", "list": null, "void": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 113, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 112, "char": 17 }, { "visibility": [ "private" ], "type": "method", "name": "initAdmin", "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 122, "char": 17 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 122, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 122, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 122, "char": 27 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "please invoke method setMongoClient before initAdmin", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 123, "char": 79 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 123, "char": 79 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 123, "char": 80 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 124, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 126, "char": 4 }, { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 126, "char": 17 }, "right": { "type": "variable", "value": "_admin", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 126, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 126, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 126, "char": 25 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_admin", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 127, "char": 28 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 127, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 127, "char": 37 }, "name": "selectDB", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": "admin", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 127, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 127, "char": 54 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 127, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 127, "char": 55 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 128, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 129, "char": 2 } ], "return-type": { "type": "return-type", "list": null, "void": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 121, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 120, "char": 17 }, { "visibility": [ "private" ], "type": "method", "name": "initBackup", "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 133, "char": 17 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 133, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 133, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 133, "char": 27 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "please invoke method setMongoClient before initBackup", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 134, "char": 80 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 134, "char": 80 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 134, "char": 81 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 135, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 137, "char": 4 }, { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 137, "char": 17 }, "right": { "type": "variable", "value": "_backup", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 137, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 137, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 137, "char": 26 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_backup", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 138, "char": 29 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 138, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 138, "char": 38 }, "name": "selectDB", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": "backup", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 138, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 138, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 138, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 138, "char": 57 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 139, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 140, "char": 2 } ], "return-type": { "type": "return-type", "list": null, "void": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 132, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 131, "char": 17 }, { "visibility": [ "private" ], "type": "method", "name": "initMapreduce", "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 144, "char": 17 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 144, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 144, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 144, "char": 27 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "please invoke method setMongoClient before initMapreduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 145, "char": 83 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 145, "char": 83 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 145, "char": 84 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 146, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 148, "char": 4 }, { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 148, "char": 17 }, "right": { "type": "variable", "value": "_mapreduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 148, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 148, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 148, "char": 29 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_mapreduce", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 149, "char": 32 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 149, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 149, "char": 41 }, "name": "selectDB", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": "mapreduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 149, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 149, "char": 62 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 149, "char": 63 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 149, "char": 63 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 150, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 151, "char": 2 } ], "return-type": { "type": "return-type", "list": null, "void": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 143, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 142, "char": 17 }, { "visibility": [ "private" ], "type": "method", "name": "initGridFs", "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 155, "char": 17 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 155, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 155, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 155, "char": 27 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "please invoke method setMongoClient before init", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 156, "char": 74 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 156, "char": 74 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 156, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 157, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 158, "char": 4 }, { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 158, "char": 17 }, "right": { "type": "variable", "value": "_db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 158, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 158, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 158, "char": 23 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "please invoke method initdb before initGridFs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 159, "char": 72 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 159, "char": 72 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 159, "char": 73 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 160, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 162, "char": 4 }, { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 162, "char": 17 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 162, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 162, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 162, "char": 22 }, "statements": [ { "type": "if", "expr": { "type": "fcall", "name": "class_exists", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": "\\MongoGridFS", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 163, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 163, "char": 34 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 163, "char": 36 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "object-property", "operator": "assign", "variable": "this", "property": "_fs", "expr": { "type": "new", "class": "\\MongoGridFS", "dynamic": 0, "parameters": [ { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 43 }, "right": { "type": "variable", "value": "_db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 47 }, { "parameter": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 68 }, "right": { "type": "variable", "value": "GRIDFS_PREFIX", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 68 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 68 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 68 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 69 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 164, "char": 69 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 165, "char": 4 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 165, "char": 5 }, { "type": "empty", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 166, "char": 3 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 167, "char": 2 } ], "return-type": { "type": "return-type", "list": null, "void": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 154, "char": 2 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 153, "char": 17 }, { "visibility": [ "private" ], "type": "method", "name": "appendQuery", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 173, "char": 50 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 173, "char": 50 } ], "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 175, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 175, "char": 24 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 176, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 176, "char": 27 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 177, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 179, "char": 10 }, { "type": "if", "expr": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 179, "char": 17 }, "right": { "type": "variable", "value": "_noAppendQuery", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 179, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 179, "char": 33 }, "statements": [ { "type": "return", "expr": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 180, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 181, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 183, "char": 13 }, { "type": "declare", "data-type": "array", "variables": [ { "variable": "keys", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 183, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 183, "char": 24 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 184, "char": 13 }, { "type": "declare", "data-type": "array", "variables": [ { "variable": "intersect", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 184, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 184, "char": 29 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 186, "char": 10 }, { "type": "if", "expr": { "type": "equals", "left": { "type": "typeof", "left": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 186, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 186, "char": 26 }, "right": { "type": "string", "value": "array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 186, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 186, "char": 36 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "keys", "expr": { "type": "cast", "left": "array", "right": { "type": "fcall", "name": "array_keys", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 187, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 187, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 187, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 187, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 187, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 12 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "intersect", "expr": { "type": "cast", "left": "array", "right": { "type": "fcall", "name": "array_intersect", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 54 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 61 }, "right": { "type": "variable", "value": "_queryHaystack", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 76 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 77 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 77 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 188, "char": 77 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 189, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 191, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "intersect", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 191, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 191, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 191, "char": 30 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "$and", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 193, "char": 24 }, "value": { "type": "array", "left": [ { "value": { "type": "array", "left": [ { "key": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 195, "char": 39 }, "value": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 196, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 196, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 196, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 196, "char": 22 }, { "value": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 198, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 198, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 199, "char": 13 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 199, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 199, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 199, "char": 14 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 200, "char": 9 } ], "else_statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "query", "index-expr": [ { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 201, "char": 36 } ], "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 201, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 201, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 202, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 203, "char": 14 }, { "type": "return", "expr": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 203, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 204, "char": 5 } ], "docblock": "**\r\n\t * 添加查询扩展参数__REMOVED__ \r\n     *\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 173, "char": 17 }, { "visibility": [ "private" ], "type": "method", "name": "checkKeyExistInArray", "parameters": [ { "type": "parameter", "name": "arr", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 214, "char": 53 }, { "type": "parameter", "name": "keys", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 214, "char": 59 } ], "statements": [ { "type": "if", "expr": { "type": "equals", "left": { "type": "typeof", "left": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 216, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 216, "char": 25 }, "right": { "type": "string", "value": "string", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 216, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 216, "char": 36 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "keys", "expr": { "type": "array", "left": [ { "value": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 217, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 217, "char": 26 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 217, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 217, "char": 27 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 218, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 220, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 220, "char": 16 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 221, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "items", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 221, "char": 18 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 222, "char": 11 }, { "type": "for", "expr": { "type": "variable", "value": "arr", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 222, "char": 31 }, "key": "key", "value": "items", "reverse": 0, "statements": [ { "type": "if", "expr": { "type": "fcall", "name": "in_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 224, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 224, "char": 25 }, { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 224, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 224, "char": 31 }, { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 224, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 224, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 224, "char": 39 }, "statements": [ { "type": "return", "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 225, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 226, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 228, "char": 11 }, { "type": "if", "expr": { "type": "equals", "left": { "type": "typeof", "left": { "type": "variable", "value": "items", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 228, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 228, "char": 27 }, "right": { "type": "string", "value": "array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 228, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 228, "char": 37 }, "statements": [ { "type": "if", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 229, "char": 19 }, "name": "checkKeyExistInArray", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "items", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 229, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 229, "char": 46 }, { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 229, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 229, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 229, "char": 54 }, "statements": [ { "type": "return", "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 230, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 231, "char": 11 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 232, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 233, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 235, "char": 14 }, { "type": "return", "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 235, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 236, "char": 5 } ], "docblock": "**\r\n     * 检查某个数组中，是否包含某个键\r\n     *\r\n     * @param array array            \r\n     * @param array keys            \r\n     * @return boolean\r\n     *", "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "data-type": "bool", "mandatory": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 215, "char": 5 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 215, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 214, "char": 20 }, { "visibility": [ "private" ], "type": "method", "name": "addSharedKeyToQuery", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 244, "char": 60 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 244, "char": 60 } ], "statements": [ { "type": "if", "expr": { "type": "not-equals", "left": { "type": "typeof", "left": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 246, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 246, "char": 26 }, "right": { "type": "string", "value": "array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 246, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 246, "char": 36 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "query must be array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 247, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 247, "char": 53 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 247, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 248, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 248, "char": 10 }, { "type": "empty", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 10 }, { "type": "if", "expr": { "type": "list", "left": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 18 }, "name": "checkKeyExistInArray", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 45 }, { "parameter": { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 250, "char": 55 }, "statements": [ { "type": "return", "expr": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 251, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 252, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 254, "char": 13 }, { "type": "declare", "data-type": "array", "variables": [ { "variable": "keys", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 254, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 254, "char": 24 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 255, "char": 13 }, { "type": "declare", "data-type": "array", "variables": [ { "variable": "intersect", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 255, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 255, "char": 29 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 257, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "keys", "expr": { "type": "cast", "left": "array", "right": { "type": "fcall", "name": "array_keys", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 257, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 257, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 257, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 257, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 257, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "intersect", "expr": { "type": "cast", "left": "array", "right": { "type": "fcall", "name": "array_intersect", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 53 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 60 }, "right": { "type": "variable", "value": "_queryHaystack", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 75 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 258, "char": 76 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 260, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "intersect", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 260, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 260, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 260, "char": 30 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "$and", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 262, "char": 24 }, "value": { "type": "array", "left": [ { "value": { "type": "array", "left": [ { "key": { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 264, "char": 31 }, "value": { "type": "new", "class": "\\MongoId", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 265, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 265, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 265, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 265, "char": 22 }, { "value": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 267, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 267, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 268, "char": 13 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 268, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 268, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 268, "char": 14 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 269, "char": 9 } ], "else_statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "query", "index-expr": [ { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 270, "char": 28 } ], "expr": { "type": "new", "class": "\\MongoId", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 270, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 270, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 271, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 272, "char": 14 }, { "type": "return", "expr": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 272, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 273, "char": 5 } ], "docblock": "**\r\n     * ICC采用_id自动分片机制，故需要判断是否增加片键字段，用于分片集合update数据时使用upsert:true的情况\r\n     *\r\n     * @param array query            \r\n     * @return multitype: Ambigous multitype:\\MongoId >\r\n     *", "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "data-type": "array", "mandatory": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 245, "char": 5 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 245, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 244, "char": 20 }, { "visibility": [ "private" ], "type": "method", "name": "search", "parameters": [ { "type": "parameter", "name": "text", "const": 0, "data-type": "string", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 280, "char": 40 } ], "statements": [ { "type": "return", "expr": { "type": "new", "class": "\\MongoRegex", "dynamic": 0, "parameters": [ { "parameter": { "type": "concat", "left": { "type": "concat", "left": { "type": "string", "value": "\/", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 36 }, "right": { "type": "fcall", "name": "preg_replace", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": "\/[\\s\\r\\t\\n]\/", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 65 }, { "parameter": { "type": "string", "value": ".*", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 71 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 71 }, { "parameter": { "type": "variable", "value": "text", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 77 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 77 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 79 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 79 }, "right": { "type": "string", "value": "\/i", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 85 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 282, "char": 86 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 283, "char": 5 } ], "docblock": "**\r\n     * 处理检索条件\r\n     *\r\n     * @param string text            \r\n     *", "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "cast": { "type": "variable", "value": "\\MongoRegex", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 281, "char": 5 }, "collection": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 281, "char": 5 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 281, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 280, "char": 20 }, { "visibility": [ "public" ], "type": "method", "name": "aggregate", "parameters": [ { "type": "parameter", "name": "pipeline", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 291, "char": 39 } ], "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 293, "char": 23 }, "right": { "type": "variable", "value": "_noAppendQuery", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 293, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 293, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 293, "char": 39 }, "statements": [ { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "array-access", "left": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 294, "char": 30 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 294, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 294, "char": 33 }, "right": { "type": "string", "value": "$geoNear", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 294, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 294, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 294, "char": 46 }, "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "first", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 295, "char": 26 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 296, "char": 19 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "first", "expr": { "type": "fcall", "name": "array_shift", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 296, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 296, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 296, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 296, "char": 50 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 297, "char": 29 }, { "type": "fcall", "expr": { "type": "fcall", "name": "array_unshift", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 297, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 297, "char": 39 }, { "parameter": { "type": "array", "left": [ { "key": { "type": "string", "value": "$match", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 298, "char": 30 }, "value": { "type": "array", "left": [ { "key": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 299, "char": 39 }, "value": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 300, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 300, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 301, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 301, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 301, "char": 18 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 301, "char": 18 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 301, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 302, "char": 29 }, { "type": "fcall", "expr": { "type": "fcall", "name": "array_unshift", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 302, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 302, "char": 39 }, { "parameter": { "type": "variable", "value": "first", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 302, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 302, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 302, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 303, "char": 13 } ], "elseif_statements": [ { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "array-access", "left": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 303, "char": 36 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 303, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 303, "char": 39 }, "right": { "type": "string", "value": "$match", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 303, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 303, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 303, "char": 50 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "pipeline", "index-expr": [ { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 31 }, { "type": "string", "value": "match", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 40 } ], "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 49 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "array-access", "left": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 70 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 72 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 73 }, "right": { "type": "string", "value": "$match", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 82 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 83 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 83 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 84 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 305, "char": 84 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 306, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 306, "char": 18 } ], "else_statements": [ { "type": "fcall", "expr": { "type": "fcall", "name": "array_unshift", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 307, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 307, "char": 39 }, { "parameter": { "type": "array", "left": [ { "key": { "type": "string", "value": "$match", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 308, "char": 30 }, "value": { "type": "array", "left": [ { "key": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 309, "char": 39 }, "value": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 310, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 310, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 311, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 311, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 311, "char": 18 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 311, "char": 18 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 311, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 312, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 313, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 315, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 315, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 315, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 315, "char": 34 }, "name": "aggregate", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "pipeline", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 315, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 315, "char": 53 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 315, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 316, "char": 5 } ], "docblock": "**\r\n     * aggregate框架指令达成\r\n     *\r\n     * @return mixed\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 291, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "batchInsert", "parameters": [ { "type": "parameter", "name": "documents", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 323, "char": 49 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 323, "char": 71 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 323, "char": 71 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "row", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 325, "char": 16 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 326, "char": 11 }, { "type": "for", "expr": { "type": "variable", "value": "documents", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 326, "char": 30 }, "value": "row", "reverse": 0, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "row", "index-expr": [ { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 327, "char": 38 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 327, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 327, "char": 58 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 328, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "row", "index-expr": [ { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 328, "char": 38 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 328, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 328, "char": 58 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 329, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "row", "index-expr": [ { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 329, "char": 34 } ], "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 329, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 329, "char": 43 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 330, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 330, "char": 10 }, { "type": "empty", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 34 }, "name": "batchInsert", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "documents", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 56 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 65 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 331, "char": 66 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 332, "char": 5 } ], "docblock": "**\r\n     * 批量插入数据\r\n     *\r\n     * @see MongoCollection::batchInsert()\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 323, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "count", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 339, "char": 46 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 339, "char": 46 }, { "type": "parameter", "name": "limit", "const": 0, "data-type": "variable", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 339, "char": 60 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 339, "char": 60 }, { "type": "parameter", "name": "skip", "const": 0, "data-type": "variable", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 339, "char": 73 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 339, "char": 73 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 341, "char": 26 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 341, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 341, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 341, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 341, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 34 }, "name": "count", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 46 }, { "parameter": { "type": "variable", "value": "limit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 53 }, { "parameter": { "type": "variable", "value": "skip", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 59 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 59 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 342, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 343, "char": 5 } ], "docblock": "**\r\n     * 统计符合条件的数量\r\n     *\r\n     * @see MongoCollection::count()\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 339, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "distinct", "parameters": [ { "type": "parameter", "name": "key", "const": 0, "data-type": "string", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 351, "char": 41 }, { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 351, "char": 62 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 351, "char": 62 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 353, "char": 26 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 353, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 353, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 353, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 353, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 34 }, "name": "distinct", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 47 }, { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 54 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 354, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 355, "char": 5 } ], "docblock": "**\r\n     * 根据指定字段\r\n     *\r\n     * @param string key            \r\n     * @param array query            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 351, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "drop", "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "targetCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 370, "char": 29 }, { "variable": "target", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 370, "char": 36 }, { "variable": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 370, "char": 43 }, { "variable": "row", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 370, "char": 47 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "targetCollection", "expr": { "type": "concat", "left": { "type": "concat", "left": { "type": "concat", "left": { "type": "string", "value": "bak_", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 39 }, "right": { "type": "fcall", "name": "date", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": "YmdHis", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 54 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 56 }, "right": { "type": "string", "value": "_", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 62 }, "right": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 69 }, "right": { "type": "variable", "value": "_collectionName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 371, "char": 85 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 372, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 372, "char": 14 }, "name": "initBackup", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 372, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "target", "expr": { "type": "new", "class": "\\MongoCollection", "dynamic": 0, "parameters": [ { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 48 }, "right": { "type": "variable", "value": "_backup", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 56 }, { "parameter": { "type": "variable", "value": "targetCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 74 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 74 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 373, "char": 75 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 375, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "cursor", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 375, "char": 27 }, "name": "find", "call-type": 1, "parameters": [ { "parameter": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 375, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 375, "char": 35 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 375, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 375, "char": 36 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 376, "char": 13 }, { "type": "while", "expr": { "type": "list", "left": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 376, "char": 23 }, "name": "hasNext", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 376, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 376, "char": 35 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "row", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 377, "char": 30 }, "name": "getNext", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 377, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 377, "char": 40 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 378, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "row", "index-expr": [ { "type": "string", "value": "__OLD_ID__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 378, "char": 33 } ], "expr": { "type": "array-access", "left": { "type": "variable", "value": "row", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 378, "char": 40 }, "right": { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 378, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 378, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 378, "char": 47 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 379, "char": 17 }, { "type": "unset", "expr": { "type": "list", "left": { "type": "array-access", "left": { "type": "variable", "value": "row", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 379, "char": 22 }, "right": { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 379, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 379, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 379, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 380, "char": 18 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "target", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 380, "char": 20 }, "name": "insert", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "row", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 380, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 380, "char": 31 }, { "parameter": { "type": "array", "left": [ { "key": { "type": "string", "value": "w", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 381, "char": 21 }, "value": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 382, "char": 13 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 382, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 382, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 382, "char": 14 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 382, "char": 15 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 383, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 384, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 384, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 384, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 384, "char": 34 }, "name": "drop", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 384, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 385, "char": 5 } ], "docblock": "**\r\n     * 直接禁止drop操作,注意备份表中只包含当前集合中的有效数据，__REMOVED__为true的不在此列\r\n     *\r\n     * 仅适合数据量操作能在脚本生命周期内能够完成的\r\n     *\r\n     * @see MongoCollection::drop()\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 365, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "physicalDrop", "statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 392, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 392, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 392, "char": 34 }, "name": "drop", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 392, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 393, "char": 5 } ], "docblock": "**\r\n     * 物理删除数据集合\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 390, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "ensureIndex", "parameters": [ { "type": "parameter", "name": "keys", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 400, "char": 44 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 400, "char": 67 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 400, "char": 67 } ], "statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 402, "char": 21 }, "name": "createIndex", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 402, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 402, "char": 38 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 402, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 402, "char": 47 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 402, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 403, "char": 5 } ], "docblock": "**\r\n     * 新驱动已经抛弃了该方法，但是为了保持一致性，继续支持，但是不建议采用\r\n     *\r\n     * @see MongoCollection::ensureIndex()\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 400, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "createIndex", "parameters": [ { "type": "parameter", "name": "keys", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 411, "char": 44 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 411, "char": 67 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 411, "char": 67 } ], "statements": [ { "type": "if", "expr": { "type": "unlikely", "left": { "type": "equals", "left": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 413, "char": 26 }, "name": "checkIndexExist", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 413, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 413, "char": 47 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 413, "char": 50 }, "right": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 413, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 413, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 413, "char": 57 }, "statements": [ { "type": "return", "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 414, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 415, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 416, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 416, "char": 27 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 417, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "defaultOptions", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 417, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 417, "char": 32 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 418, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "defaultOptions", "index-expr": [ { "type": "string", "value": "background", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 418, "char": 40 } ], "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 418, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 418, "char": 48 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 419, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "defaultOptions", "index-expr": [ { "type": "string", "value": "w", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 419, "char": 31 } ], "expr": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 419, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 419, "char": 36 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "identical", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 34 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 42 }, "right": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 59 }, "extra": { "type": "fcall", "name": "array_merge", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 87 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 87 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 96 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 96 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 420, "char": 97 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 10 }, { "type": "if", "expr": { "type": "fcall", "name": "version_compare", "call-type": 1, "parameters": [ { "parameter": { "type": "static-constant-access", "left": { "type": "variable", "value": "\\MongoClient", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 49 }, "right": { "type": "variable", "value": "VERSION", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 49 }, { "parameter": { "type": "string", "value": "1.5.0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 58 }, { "parameter": { "type": "string", "value": ">=", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 64 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 64 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 421, "char": 66 }, "statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 25 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 38 }, "name": "createIndex", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 55 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 64 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 64 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 422, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 423, "char": 9 } ], "else_statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 25 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 38 }, "name": "ensureIndex", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 55 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 64 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 64 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 424, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 425, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 426, "char": 5 } ], "docblock": "**\r\n     * 新的写法，创建索引\r\n     *\r\n     * @param array keys            \r\n     * @param array options            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 411, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "checkIndexExist", "parameters": [ { "type": "parameter", "name": "keys", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 434, "char": 48 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "indexes", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 436, "char": 20 }, { "variable": "index", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 436, "char": 26 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 437, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "indexes", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 437, "char": 28 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 437, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 437, "char": 41 }, "name": "getIndexInfo", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 437, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 437, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 10 }, { "type": "if", "expr": { "type": "and", "left": { "type": "not", "left": { "type": "empty", "left": { "type": "list", "left": { "type": "variable", "value": "indexes", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 30 }, "right": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "indexes", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 48 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 438, "char": 50 }, "statements": [ { "type": "for", "expr": { "type": "variable", "value": "indexes", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 439, "char": 34 }, "value": "index", "reverse": 0, "statements": [ { "type": "if", "expr": { "type": "equals", "left": { "type": "array-access", "left": { "type": "variable", "value": "index", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 440, "char": 25 }, "right": { "type": "string", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 440, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 440, "char": 34 }, "right": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 440, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 440, "char": 41 }, "statements": [ { "type": "return", "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 441, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 442, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 443, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 444, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 445, "char": 14 }, { "type": "return", "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 445, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 446, "char": 5 } ], "docblock": "**\r\n     * 检测集合的某个索引是否存在\r\n     *\r\n     * @param array keys            \r\n     * @return boolean\r\n     *", "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "data-type": "bool", "mandatory": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 435, "char": 5 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 435, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 434, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "find", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 454, "char": 45 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 454, "char": 45 }, { "type": "parameter", "name": "fields", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 454, "char": 67 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 454, "char": 67 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "fields", "expr": { "type": "ternary", "left": { "type": "empty", "left": { "type": "list", "left": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 456, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 456, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 456, "char": 36 }, "right": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 456, "char": 41 }, "extra": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 456, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 456, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 456, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 457, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 457, "char": 26 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 457, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 457, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 457, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 457, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 34 }, "name": "find", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 45 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 53 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 458, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 459, "char": 5 } ], "docblock": "**\r\n     * 查询符合条件的项目，自动排除__REMOVED__:true的结果集\r\n     *\r\n     * @see MongoCollection::find()\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 454, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "findOne", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 466, "char": 48 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 466, "char": 48 }, { "type": "parameter", "name": "fields", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 466, "char": 70 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 466, "char": 70 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "fields", "expr": { "type": "ternary", "left": { "type": "empty", "left": { "type": "list", "left": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 468, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 468, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 468, "char": 36 }, "right": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 468, "char": 41 }, "extra": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 468, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 468, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 468, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 469, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 469, "char": 26 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 469, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 469, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 469, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 469, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 34 }, "name": "findOne", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 48 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 470, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 471, "char": 5 } ], "docblock": "**\r\n     * 查询符合条件的一条数据\r\n     *\r\n     * @see MongoCollection::findOne()\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 466, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "findAll", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 46 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 46 }, { "type": "parameter", "name": "sort", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "array", "left": [ { "key": { "type": "string", "value": "natural", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 72 }, "value": { "type": "int", "value": "1", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 74 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 74 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 75 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 75 }, { "type": "parameter", "name": "skip", "const": 0, "data-type": "int", "mandatory": 0, "default": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 89 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 89 }, { "type": "parameter", "name": "limit", "const": 0, "data-type": "int", "mandatory": 0, "default": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 104 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 104 }, { "type": "parameter", "name": "fields", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 124 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 124 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "fields", "expr": { "type": "ternary", "left": { "type": "empty", "left": { "type": "list", "left": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 485, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 485, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 485, "char": 36 }, "right": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 485, "char": 41 }, "extra": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 485, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 485, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 485, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 486, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 486, "char": 19 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "cursor", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 27 }, "name": "find", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 38 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 487, "char": 47 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 488, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 488, "char": 30 }, "right": { "type": "variable", "value": "\\MongoCursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 488, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 488, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 488, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 488, "char": 46 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "concat", "left": { "type": "string", "value": "query error:", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 489, "char": 49 }, "right": { "type": "fcall", "name": "json_encode", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 489, "char": 68 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 489, "char": 68 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 489, "char": 69 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 489, "char": 69 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 489, "char": 69 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 489, "char": 70 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 490, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 492, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 492, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 492, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 492, "char": 24 }, "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 493, "char": 20 }, "name": "sort", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 493, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 493, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 493, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 494, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 496, "char": 10 }, { "type": "if", "expr": { "type": "greater", "left": { "type": "variable", "value": "skip", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 496, "char": 17 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 496, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 496, "char": 21 }, "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 497, "char": 20 }, "name": "skip", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "skip", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 497, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 497, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 497, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 498, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 500, "char": 10 }, { "type": "if", "expr": { "type": "greater", "left": { "type": "variable", "value": "limit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 500, "char": 18 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 500, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 500, "char": 22 }, "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 501, "char": 20 }, "name": "limit", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "limit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 501, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 501, "char": 32 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 501, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 502, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 504, "char": 10 }, { "type": "if", "expr": { "type": "instanceof", "left": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 504, "char": 28 }, "right": { "type": "variable", "value": "\\Traversable", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 504, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 504, "char": 43 }, "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "result", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 505, "char": 23 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 506, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "result", "expr": { "type": "fcall", "name": "iterator_to_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 506, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 506, "char": 50 }, { "parameter": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 506, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 506, "char": 57 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 506, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 506, "char": 58 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 507, "char": 18 }, { "type": "return", "expr": { "type": "variable", "value": "result", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 507, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 508, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 510, "char": 14 }, { "type": "return", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 510, "char": 18 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 511, "char": 5 } ], "docblock": "**\r\n     * 获取符合条件的全部数据\r\n     *\r\n     * @param array query            \r\n     * @param array sort            \r\n     * @param int skip            \r\n     * @param int limit            \r\n     * @param array fields            \r\n     * @return array\r\n     *", "return-type": { "type": "return-type", "list": [ { "type": "return-type-parameter", "data-type": "array", "mandatory": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 484, "char": 5 } ], "void": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 484, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 483, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "findAndModify", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 47 }, { "type": "parameter", "name": "update", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 69 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 69 }, { "type": "parameter", "name": "fields", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 91 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 91 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 114 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 114 } ], "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 525, "char": 26 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 525, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 525, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 525, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 525, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 10 }, { "type": "if", "expr": { "type": "and", "left": { "type": "equals", "left": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 17 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 30 }, "name": "count", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 42 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 42 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 45 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 50 }, "right": { "type": "not", "left": { "type": "empty", "left": { "type": "array-access", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 66 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 77 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 77 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 77 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 526, "char": 77 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 527, "char": 30 }, "name": "addSharedKeyToQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 527, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 527, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 527, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 527, "char": 57 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 528, "char": 9 } ], "else_statements": [ { "type": "unset", "expr": { "type": "list", "left": { "type": "array-access", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 529, "char": 26 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 529, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 529, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 529, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 530, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 34 }, "name": "findAndModify", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 54 }, { "parameter": { "type": "variable", "value": "update", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 62 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 70 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 70 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 79 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 79 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 531, "char": 80 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 532, "char": 5 } ], "docblock": "**\r\n     * findAndModify操作\r\n     * 特别注意：__REMOVED__ __MODIFY_TIME__ __CREATE_TIME__ 3个系统保留变量在update参数中的使用\r\n     *\r\n     * @param array query            \r\n     * @param array update            \r\n     * @param array fields            \r\n     * @param array options            \r\n     * @return array\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 523, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "findAndModifyByCommand", "parameters": [ { "type": "parameter", "name": "option", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 542, "char": 57 }, { "type": "parameter", "name": "collection", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 542, "char": 83 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 542, "char": 83 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "cmd", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 544, "char": 16 }, { "variable": "targetCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 544, "char": 33 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 545, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "cmd", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 545, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 545, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "targetCollection", "expr": { "type": "ternary", "left": { "type": "identical", "left": { "type": "variable", "value": "collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 45 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 52 }, "right": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 59 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 72 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 72 }, "extra": { "type": "variable", "value": "collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 84 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 84 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 546, "char": 84 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 547, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "findandmodify", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 547, "char": 32 } ], "expr": { "type": "variable", "value": "targetCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 547, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 547, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 548, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 548, "char": 24 }, "right": { "type": "string", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 548, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 548, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 548, "char": 34 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 28 } ], "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 37 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 56 }, "right": { "type": "string", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 64 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 65 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 66 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 549, "char": 66 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 550, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 551, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 551, "char": 24 }, "right": { "type": "string", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 551, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 551, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 551, "char": 33 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 552, "char": 27 } ], "expr": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 552, "char": 37 }, "right": { "type": "string", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 552, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 552, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 552, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 553, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 554, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 554, "char": 24 }, "right": { "type": "string", "value": "remove", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 554, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 554, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 554, "char": 35 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "remove", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 29 } ], "expr": { "type": "ternary", "left": { "type": "fcall", "name": "is_bool", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 47 }, "right": { "type": "string", "value": "remove", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 57 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 59 }, "right": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 67 }, "right": { "type": "string", "value": "remove", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 78 }, "extra": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 555, "char": 85 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 556, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 557, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 557, "char": 24 }, "right": { "type": "string", "value": "update", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 557, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 557, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 557, "char": 35 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "update", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 558, "char": 29 } ], "expr": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 558, "char": 39 }, "right": { "type": "string", "value": "update", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 558, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 558, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 558, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 559, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 560, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 560, "char": 24 }, "right": { "type": "string", "value": "new", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 560, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 560, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 560, "char": 32 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "new", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 26 } ], "expr": { "type": "ternary", "left": { "type": "fcall", "name": "is_bool", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 44 }, "right": { "type": "string", "value": "new", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 51 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 53 }, "right": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 61 }, "right": { "type": "string", "value": "new", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 67 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 69 }, "extra": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 561, "char": 76 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 562, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 563, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 563, "char": 24 }, "right": { "type": "string", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 563, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 563, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 563, "char": 35 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 564, "char": 29 } ], "expr": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 564, "char": 39 }, "right": { "type": "string", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 564, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 564, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 564, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 565, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 566, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 566, "char": 24 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 566, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 566, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 566, "char": 35 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 29 } ], "expr": { "type": "ternary", "left": { "type": "fcall", "name": "is_bool", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 47 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 57 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 59 }, "right": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 67 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 76 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 78 }, "extra": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 567, "char": 85 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 568, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 10 }, { "type": "if", "expr": { "type": "and", "left": { "type": "equals", "left": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 17 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 30 }, "name": "count", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "variable", "value": "cmd", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 40 }, "right": { "type": "string", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 52 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 57 }, "right": { "type": "not", "left": { "type": "empty", "left": { "type": "array-access", "left": { "type": "variable", "value": "option", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 72 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 81 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 83 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 83 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 83 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 569, "char": 83 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "cmd", "index-expr": [ { "type": "string", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 28 } ], "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 37 }, "name": "addSharedKeyToQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "variable", "value": "cmd", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 61 }, "right": { "type": "string", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 69 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 70 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 70 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 71 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 570, "char": 71 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 571, "char": 9 } ], "else_statements": [ { "type": "unset", "expr": { "type": "list", "left": { "type": "array-access", "left": { "type": "variable", "value": "cmd", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 572, "char": 22 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 572, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 572, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 572, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 573, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 574, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 574, "char": 21 }, "right": { "type": "variable", "value": "_db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 574, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 574, "char": 26 }, "name": "command", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "cmd", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 574, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 574, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 574, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 575, "char": 5 } ], "docblock": "**\r\n     * 增加findAndModify方法\r\n     * 特别注意：__REMOVED__ __MODIFY_TIME__ __CREATE_TIME__ 3个系统保留变量在update参数中的使用\r\n     *\r\n     * @param array option            \r\n     * @param string collection            \r\n     * @return mixed array|null\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 542, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "insertRef", "parameters": [ { "type": "parameter", "name": "a", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 583, "char": 32 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 583, "char": 55 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 583, "char": 55 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "res", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 585, "char": 16 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 586, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "res", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 586, "char": 24 }, "name": "insertByFindAndModify", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 586, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 586, "char": 48 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 586, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 586, "char": 49 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 587, "char": 10 }, { "type": "if", "expr": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "res", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 587, "char": 21 }, "right": { "type": "string", "value": "ok", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 587, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 587, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 587, "char": 28 }, "statements": [ { "type": "return", "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 588, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 589, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 590, "char": 14 }, { "type": "return", "expr": { "type": "variable", "value": "res", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 590, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 591, "char": 5 } ], "docblock": "**\r\n     * 插入特定的数据,并保持insert第一个参数a在没有_id的时候添加_id属性\r\n     *\r\n     * @param array object            \r\n     * @param array options            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 583, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "insert", "parameters": [ { "type": "parameter", "name": "a", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 602, "char": 36 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 602, "char": 59 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 602, "char": 59 } ], "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "list", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 604, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 604, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 604, "char": 21 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "object is NULL", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 605, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 605, "char": 50 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 605, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 606, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 608, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "defaultOptions", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 608, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 608, "char": 32 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 609, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "defaultOptions", "index-expr": [ { "type": "string", "value": "fsync", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 609, "char": 35 } ], "expr": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 609, "char": 50 }, "right": { "type": "variable", "value": "FSYNC", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 609, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 609, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 609, "char": 50 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "identical", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 34 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 42 }, "right": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 59 }, "extra": { "type": "fcall", "name": "array_merge", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 87 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 87 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 96 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 96 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 610, "char": 97 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 612, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "a", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 612, "char": 22 }, "name": "array_unset_recursive", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 612, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 612, "char": 46 }, { "parameter": { "type": "array", "left": [ { "value": { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 613, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 613, "char": 30 }, { "value": { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 614, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 614, "char": 30 }, { "value": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 616, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 616, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 616, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 616, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 616, "char": 11 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 616, "char": 11 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 618, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 618, "char": 20 }, "right": { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 618, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 618, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 618, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 618, "char": 40 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 619, "char": 36 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 619, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 619, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 620, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 622, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 622, "char": 20 }, "right": { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 622, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 622, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 622, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 622, "char": 40 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 623, "char": 36 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 623, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 623, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 624, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 10 }, { "type": "if", "expr": { "type": "and", "left": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 20 }, "right": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 37 }, "right": { "type": "not", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 45 }, "right": { "type": "variable", "value": "_noAppendQuery", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 626, "char": 61 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 627, "char": 32 } ], "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 627, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 627, "char": 41 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 628, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 34 }, "name": "insert", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 43 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 630, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 631, "char": 5 } ], "docblock": "**\r\n     * 插入特定的数据，注意此方法無法針對a添加_id属性，详见参数丢失原因的文档说明\r\n     * 解决这个问题，请使用上面的方法insertRef\r\n     * 注意因为参数检查的原因，无法直接覆盖insert方法并采用引用，如下原因\r\n     * <b>Strict Standards<\/b>: Declaration of My\\Common\\MongoCollection::insert() should be compatible with MongoCollection::insert(array_of_fields_OR_object, array options = NULL)\r\n     *\r\n     * @param array object            \r\n     * @param array options            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 602, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "insertByFindAndModify", "parameters": [ { "type": "parameter", "name": "a", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 641, "char": 44 } ], "statements": [ { "type": "if", "expr": { "type": "empty", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 643, "char": 20 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 643, "char": 20 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "a is NULL", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 644, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 644, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 644, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 645, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 647, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 647, "char": 18 }, { "variable": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 647, "char": 25 }, { "variable": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 647, "char": 33 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 648, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "a", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 648, "char": 22 }, "name": "array_unset_recursive", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 648, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 648, "char": 46 }, { "parameter": { "type": "array", "left": [ { "value": { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 649, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 649, "char": 30 }, { "value": { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 650, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 650, "char": 30 }, { "value": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 652, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 652, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 652, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 652, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 652, "char": 11 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 652, "char": 11 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 654, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 654, "char": 20 }, "right": { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 654, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 654, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 654, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 654, "char": 40 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 655, "char": 36 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 655, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 655, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 656, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 658, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 658, "char": 20 }, "right": { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 658, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 658, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 658, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 658, "char": 40 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 659, "char": 36 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 659, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 659, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 660, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 662, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 662, "char": 20 }, "right": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 662, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 662, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 662, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 662, "char": 36 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 663, "char": 32 } ], "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 663, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 663, "char": 41 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 664, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 666, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 667, "char": 19 }, "value": { "type": "new", "class": "\\MongoId", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 668, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 668, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 668, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 668, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 669, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "a", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "$set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 670, "char": 20 }, "value": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 671, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 671, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 671, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 671, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 672, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "fields", "expr": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 672, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 672, "char": 26 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 673, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "new", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 674, "char": 19 }, "value": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 674, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 674, "char": 25 }, { "key": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 675, "char": 22 }, "value": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 676, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 676, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 676, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 676, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 34 }, "name": "findAndModify", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 54 }, { "parameter": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 57 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 65 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 74 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 74 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 678, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 679, "char": 5 } ], "docblock": "**\r\n     * 通过findAndModify的方式，插入数据。\r\n     * 这样可以使用a[\"a.b\"]的方式插入结构为{a:{b:xxx}}的数据,这是insert所不能办到的\r\n     * 采用update也可以实现类似的效果，区别在于findAndModify可以返回插入之后的新数据，更接近insert的原始行为\r\n     *\r\n     * @param array a            \r\n     * @return array\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 641, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "remove", "parameters": [ { "type": "parameter", "name": "criteria", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 687, "char": 50 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 687, "char": 50 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 687, "char": 73 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 687, "char": 73 } ], "statements": [ { "type": "if", "expr": { "type": "identical", "left": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 689, "char": 23 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 689, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 689, "char": 30 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "criteria is NULL", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 690, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 690, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 690, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 691, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 693, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "defaultOptions", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 693, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 693, "char": 32 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 694, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "defaultOptions", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "justOne", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 695, "char": 23 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 695, "char": 38 }, "right": { "type": "variable", "value": "JUSTONE", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 695, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 695, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 695, "char": 38 }, { "key": { "type": "string", "value": "fsync", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 696, "char": 21 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 697, "char": 9 }, "right": { "type": "variable", "value": "FSYNC", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 697, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 697, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 697, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 697, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 697, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "identical", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 34 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 42 }, "right": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 59 }, "extra": { "type": "fcall", "name": "array_merge", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 87 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 87 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 96 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 96 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 699, "char": 97 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 10 }, { "type": "if", "expr": { "type": "and", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 25 }, "right": { "type": "string", "value": "justOne", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 38 }, "right": { "type": "not", "left": { "type": "array-access", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 48 }, "right": { "type": "string", "value": "justOne", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 701, "char": 60 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "options", "index-expr": [ { "type": "string", "value": "multiple", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 702, "char": 35 } ], "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 702, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 702, "char": 43 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 703, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 705, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "criteria", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 705, "char": 29 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 705, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 705, "char": 50 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 705, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 705, "char": 51 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 706, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 706, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 706, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 706, "char": 34 }, "name": "update", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 706, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 706, "char": 50 }, { "parameter": { "type": "array", "left": [ { "key": { "type": "string", "value": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 707, "char": 19 }, "value": { "type": "array", "left": [ { "key": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 708, "char": 31 }, "value": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 709, "char": 13 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 709, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 710, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 710, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 710, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 710, "char": 10 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 710, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 710, "char": 19 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 710, "char": 20 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 711, "char": 5 } ], "docblock": "**\r\n     * 删除指定范围的数据\r\n     *\r\n     * @param array criteria            \r\n     * @param array options            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 687, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "physicalRemove", "parameters": [ { "type": "parameter", "name": "criteria", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 719, "char": 58 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 719, "char": 58 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 719, "char": 80 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 719, "char": 80 } ], "statements": [ { "type": "if", "expr": { "type": "identical", "left": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 721, "char": 23 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 721, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 721, "char": 30 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "criteria is NULL", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 722, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 722, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 722, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 723, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 725, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "defaultOptions", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 725, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 725, "char": 32 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 726, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "defaultOptions", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "justOne", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 727, "char": 23 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 727, "char": 38 }, "right": { "type": "variable", "value": "JUSTONE", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 727, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 727, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 727, "char": 38 }, { "key": { "type": "string", "value": "fsync", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 728, "char": 21 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 729, "char": 9 }, "right": { "type": "variable", "value": "FSYNC", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 729, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 729, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 729, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 729, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 729, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "identical", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 34 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 42 }, "right": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 59 }, "extra": { "type": "fcall", "name": "array_merge", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 87 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 87 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 96 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 96 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 731, "char": 97 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 34 }, "name": "remove", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 50 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 59 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 59 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 732, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 733, "char": 5 } ], "docblock": "**\r\n     * 物理删除指定范围的数据\r\n     *\r\n     * @param array criteria            \r\n     * @param array options            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 719, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "physicalUpdate", "parameters": [ { "type": "parameter", "name": "criteria", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 743, "char": 44 }, { "type": "parameter", "name": "obj", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 743, "char": 49 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 743, "char": 71 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 743, "char": 71 } ], "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 745, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 745, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 745, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 745, "char": 32 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "criteria is array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 746, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 746, "char": 53 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 746, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 747, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 749, "char": 10 }, { "type": "if", "expr": { "type": "empty", "left": { "type": "variable", "value": "obj", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 749, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 749, "char": 22 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "obj is empty", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 750, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 750, "char": 48 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 750, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 751, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 753, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 753, "char": 16 }, { "variable": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 753, "char": 21 }, { "variable": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 753, "char": 36 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 754, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "keys", "expr": { "type": "fcall", "name": "array_keys", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "obj", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 754, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 754, "char": 34 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 754, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 754, "char": 35 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 755, "char": 11 }, { "type": "for", "expr": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 755, "char": 25 }, "value": "key", "reverse": 0, "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "in_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 29 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 36 }, "right": { "type": "variable", "value": "_updateHaystack", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 52 }, { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 58 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 756, "char": 60 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "concat", "left": { "type": "string", "value": "key must contain ", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 58 }, "right": { "type": "fcall", "name": "join", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": ",", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 68 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 68 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 75 }, "right": { "type": "variable", "value": "_updateHaystack", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 91 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 91 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 91 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 92 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 92 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 92 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 757, "char": 93 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 758, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 759, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 761, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "defaultOptions", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 762, "char": 22 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 762, "char": 36 }, "right": { "type": "variable", "value": "UPSERT", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 762, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 762, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 762, "char": 36 }, { "key": { "type": "string", "value": "multiple", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 763, "char": 24 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 763, "char": 40 }, "right": { "type": "variable", "value": "MULTIPLE", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 763, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 763, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 763, "char": 40 }, { "key": { "type": "string", "value": "fsync", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 764, "char": 21 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 765, "char": 9 }, "right": { "type": "variable", "value": "FSYNC", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 765, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 765, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 765, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 765, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 765, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "identical", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 34 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 42 }, "right": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 59 }, "extra": { "type": "fcall", "name": "array_merge", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 87 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 87 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 96 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 96 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 767, "char": 97 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 34 }, "name": "update", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 50 }, { "parameter": { "type": "variable", "value": "obj", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 55 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 64 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 64 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 768, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 769, "char": 5 } ], "docblock": "**\r\n     * 物理更新数据\r\n     *\r\n     * @param array criteria            \r\n     * @param array object            \r\n     * @param array options            \r\n     * @throws \\Exception\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 743, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "update", "parameters": [ { "type": "parameter", "name": "criteria", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 778, "char": 36 }, { "type": "parameter", "name": "obj", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 778, "char": 41 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 778, "char": 63 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 778, "char": 63 } ], "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 780, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 780, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 780, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 780, "char": 32 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "criteria is array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 781, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 781, "char": 53 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 781, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 782, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 784, "char": 10 }, { "type": "if", "expr": { "type": "empty", "left": { "type": "variable", "value": "obj", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 784, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 784, "char": 22 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "object is empty", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 785, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 785, "char": 51 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 785, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 786, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 788, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 788, "char": 16 }, { "variable": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 788, "char": 21 }, { "variable": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 788, "char": 36 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 789, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "keys", "expr": { "type": "fcall", "name": "array_keys", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "obj", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 789, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 789, "char": 34 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 789, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 789, "char": 35 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 790, "char": 11 }, { "type": "for", "expr": { "type": "variable", "value": "keys", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 790, "char": 25 }, "value": "key", "reverse": 0, "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "in_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 29 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 36 }, "right": { "type": "variable", "value": "_updateHaystack", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 52 }, { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 58 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 791, "char": 60 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "concat", "left": { "type": "string", "value": "key must contain ", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 58 }, "right": { "type": "fcall", "name": "join", "call-type": 1, "parameters": [ { "parameter": { "type": "string", "value": ",", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 68 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 68 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 75 }, "right": { "type": "variable", "value": "_updateHaystack", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 91 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 91 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 91 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 92 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 92 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 92 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 792, "char": 93 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 793, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 794, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 795, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "defaultOptions", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 796, "char": 22 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 796, "char": 36 }, "right": { "type": "variable", "value": "UPSERT", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 796, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 796, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 796, "char": 36 }, { "key": { "type": "string", "value": "multiple", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 797, "char": 24 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 797, "char": 40 }, "right": { "type": "variable", "value": "MULTIPLE", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 797, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 797, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 797, "char": 40 }, { "key": { "type": "string", "value": "fsync", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 798, "char": 21 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 799, "char": 9 }, "right": { "type": "variable", "value": "FSYNC", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 799, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 799, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 799, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 799, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 799, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "identical", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 34 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 42 }, "right": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 59 }, "extra": { "type": "fcall", "name": "array_merge", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "defaultOptions", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 87 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 87 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 96 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 96 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 801, "char": 97 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 803, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "criteria", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 803, "char": 29 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 803, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 803, "char": 50 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 803, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 803, "char": 51 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 804, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "obj", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 804, "char": 24 }, "name": "array_unset_recursive", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "obj", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 804, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 804, "char": 50 }, { "parameter": { "type": "array", "left": [ { "value": { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 805, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 805, "char": 30 }, { "value": { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 806, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 806, "char": 30 }, { "value": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 808, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 808, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 808, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 808, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 808, "char": 11 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 808, "char": 11 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 10 }, { "type": "if", "expr": { "type": "list", "left": { "type": "unlikely", "left": { "type": "equals", "left": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 27 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 40 }, "name": "count", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 55 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 58 }, "right": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 810, "char": 63 }, "statements": [ { "type": "if", "expr": { "type": "and", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 29 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 41 }, "right": { "type": "array-access", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 50 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 59 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 811, "char": 61 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "criteria", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 812, "char": 37 }, "name": "addSharedKeyToQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 812, "char": 66 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 812, "char": 66 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 812, "char": 67 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 812, "char": 67 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 813, "char": 20 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 813, "char": 22 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 813, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 813, "char": 35 }, "name": "update", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 813, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 813, "char": 51 }, { "parameter": { "type": "array", "left": [ { "key": { "type": "string", "value": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 814, "char": 27 }, "value": { "type": "array", "left": [ { "key": { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 815, "char": 43 }, "value": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 815, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 815, "char": 61 }, { "key": { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 816, "char": 43 }, "value": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 816, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 816, "char": 61 }, { "key": { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 817, "char": 39 }, "value": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 818, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 818, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 819, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 819, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 819, "char": 18 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 819, "char": 18 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 819, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 819, "char": 27 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 819, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 820, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 821, "char": 9 } ], "else_statements": [ { "type": "unset", "expr": { "type": "list", "left": { "type": "array-access", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 822, "char": 26 }, "right": { "type": "string", "value": "upsert", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 822, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 822, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 822, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 823, "char": 16 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 823, "char": 18 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 823, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 823, "char": 31 }, "name": "update", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 823, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 823, "char": 47 }, { "parameter": { "type": "array", "left": [ { "key": { "type": "string", "value": "set", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 824, "char": 23 }, "value": { "type": "array", "left": [ { "key": { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 825, "char": 39 }, "value": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 826, "char": 17 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 826, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 827, "char": 13 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 827, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 827, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 827, "char": 14 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 827, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 827, "char": 23 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 827, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 828, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 34 }, "name": "update", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "criteria", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 50 }, { "parameter": { "type": "variable", "value": "obj", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 55 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 64 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 64 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 830, "char": 65 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 831, "char": 5 } ], "docblock": "**\r\n     * 更新指定范围的数据\r\n     *\r\n     * @param array criteria            \r\n     * @param array object            \r\n     * @param array options            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 778, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "save", "parameters": [ { "type": "parameter", "name": "a", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 840, "char": 34 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 840, "char": 57 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 840, "char": 57 } ], "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 842, "char": 20 }, "right": { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 842, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 842, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 842, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 842, "char": 40 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__CREATE_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 843, "char": 36 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 843, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 843, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 844, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 845, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__REMOVED__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 845, "char": 28 } ], "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 845, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 845, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 846, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "a", "index-expr": [ { "type": "string", "value": "__MODIFY_TIME__", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 846, "char": 32 } ], "expr": { "type": "new", "class": "\\MongoDate", "dynamic": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 846, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 846, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 847, "char": 10 }, { "type": "if", "expr": { "type": "list", "left": { "type": "equals", "left": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 847, "char": 22 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 847, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 847, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 847, "char": 30 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "options", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "w", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 849, "char": 21 }, "value": { "type": "int", "value": "1", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 850, "char": 13 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 850, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 850, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 850, "char": 14 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 851, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 34 }, "name": "save", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 41 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 50 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 852, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 853, "char": 5 } ], "docblock": "**\r\n     * 保存并保持引用修改状态\r\n     *\r\n     * @param array a            \r\n     * @param array options            \r\n     * @return mixed\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 840, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "saveRef", "parameters": [ { "type": "parameter", "name": "a", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 862, "char": 37 }, { "type": "parameter", "name": "options", "const": 0, "data-type": "array", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 862, "char": 59 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 862, "char": 59 } ], "statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 864, "char": 21 }, "name": "save", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "a", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 864, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 864, "char": 28 }, { "parameter": { "type": "variable", "value": "options", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 864, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 864, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 864, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 865, "char": 5 } ], "docblock": "**\r\n     * 保存并保持引用修改状态\r\n     *\r\n     * @param array a            \r\n     * @param array options            \r\n     * @return mixed\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 862, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "command", "parameters": [ { "type": "parameter", "name": "command", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 873, "char": 43 } ], "statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 21 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 34 }, "right": { "type": "variable", "value": "db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 38 }, "name": "command", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "command", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 54 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 875, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 876, "char": 5 } ], "docblock": "**\r\n     * 执行DB的command操作,直接运行命令行操作数据库中的数据，慎用\r\n     *\r\n     * @param array command            \r\n     * @return array\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 873, "char": 19 }, { "visibility": [ "private" ], "type": "method", "name": "failure", "parameters": [ { "type": "parameter", "name": "code", "const": 0, "data-type": "int", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 882, "char": 39 }, { "type": "parameter", "name": "msg", "const": 0, "data-type": "string", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 882, "char": 52 } ], "statements": [ { "type": "if", "expr": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "msg", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 883, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 883, "char": 24 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 883, "char": 26 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "msg", "expr": { "type": "fcall", "name": "json_encode", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "msg", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 884, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 884, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 884, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 884, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 885, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 886, "char": 14 }, { "type": "return", "expr": { "type": "array", "left": [ { "key": { "type": "string", "value": "ok", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 887, "char": 18 }, "value": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 887, "char": 21 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 887, "char": 21 }, { "key": { "type": "string", "value": "code", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 888, "char": 20 }, "value": { "type": "variable", "value": "code", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 888, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 888, "char": 26 }, { "key": { "type": "string", "value": "msg", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 889, "char": 19 }, "value": { "type": "variable", "value": "msg", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 890, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 890, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 890, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 891, "char": 5 } ], "docblock": "**\r\n     * mapreduce 错误评价\r\n     *\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 882, "char": 20 }, { "visibility": [ "public" ], "type": "method", "name": "mapReduce", "parameters": [ { "type": "parameter", "name": "out", "const": 0, "data-type": "string", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 48 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 48 }, { "type": "parameter", "name": "map", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 53 }, { "type": "parameter", "name": "reduce", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 61 }, { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 80 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 80 }, { "type": "parameter", "name": "finalize", "const": 0, "data-type": "variable", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 97 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 97 }, { "type": "parameter", "name": "method", "const": 0, "data-type": "string", "mandatory": 1, "default": { "type": "string", "value": "replace", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 125 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 125 }, { "type": "parameter", "name": "scope", "const": 0, "data-type": "variable", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 139 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 139 }, { "type": "parameter", "name": "sort", "const": 0, "data-type": "variable", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 152 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 152 }, { "type": "parameter", "name": "limit", "const": 0, "data-type": "variable", "mandatory": 0, "default": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 166 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 166 } ], "statements": [ { "type": "if", "expr": { "type": "list", "left": { "type": "equals", "left": { "type": "variable", "value": "out", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 901, "char": 18 }, "right": { "type": "null", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 901, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 901, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 901, "char": 26 }, "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "arrArgs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 902, "char": 24 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 903, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "arrArgs", "expr": { "type": "fcall", "name": "func_get_args", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 903, "char": 42 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 903, "char": 42 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 904, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "out", "expr": { "type": "fcall", "name": "md5", "call-type": 1, "parameters": [ { "parameter": { "type": "fcall", "name": "serialize", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "arrArgs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 904, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 904, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 904, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 904, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 904, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 904, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 905, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 908, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "command", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 908, "char": 20 }, { "variable": "rst", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 908, "char": 24 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 909, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "command", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 909, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 909, "char": 25 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 910, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "mapreduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 910, "char": 32 } ], "expr": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 910, "char": 41 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 910, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 910, "char": 53 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 910, "char": 53 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "map", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 26 } ], "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "map", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 44 }, "right": { "type": "variable", "value": "\\MongoCode", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 58 }, "right": { "type": "variable", "value": "map", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 64 }, "extra": { "type": "new", "class": "\\MongoCode", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "map", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 84 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 84 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 85 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 911, "char": 85 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "reduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 29 } ], "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "reduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 50 }, "right": { "type": "variable", "value": "\\MongoCode", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 64 }, "right": { "type": "variable", "value": "reduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 73 }, "extra": { "type": "new", "class": "\\MongoCode", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "reduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 96 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 96 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 97 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 912, "char": 97 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 913, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 913, "char": 26 }, "name": "appendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 913, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 913, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 913, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 913, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 914, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 914, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 914, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 914, "char": 25 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 915, "char": 32 } ], "expr": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 915, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 915, "char": 41 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 916, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 918, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "finalize", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 918, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 918, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 918, "char": 28 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "finalize", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 35 } ], "expr": { "type": "ternary", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "finalize", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 58 }, "right": { "type": "variable", "value": "\\MongoCode", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 70 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 70 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 72 }, "right": { "type": "variable", "value": "finalize", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 83 }, "extra": { "type": "new", "class": "\\MongoCode", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "finalize", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 108 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 108 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 109 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 109 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 919, "char": 109 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 920, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 921, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 921, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 921, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 921, "char": 24 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 922, "char": 31 } ], "expr": { "type": "variable", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 922, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 922, "char": 39 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 923, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 924, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "limit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 924, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 924, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 924, "char": 25 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "limit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 925, "char": 32 } ], "expr": { "type": "variable", "value": "limit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 925, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 925, "char": 41 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 926, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 927, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "scope", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 927, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 927, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 927, "char": 25 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "scope", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 928, "char": 32 } ], "expr": { "type": "variable", "value": "scope", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 928, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 928, "char": 41 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 929, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 930, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "verbose", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 930, "char": 30 } ], "expr": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 930, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 930, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 932, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "in_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "method", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 932, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 932, "char": 28 }, { "parameter": { "type": "array", "left": [ { "value": { "type": "string", "value": "replace", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 933, "char": 22 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 933, "char": 22 }, { "value": { "type": "string", "value": "merge", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 934, "char": 20 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 934, "char": 20 }, { "value": { "type": "string", "value": "reduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 10 }, { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 16 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 16 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 18 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 936, "char": 18 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "method", "expr": { "type": "string", "value": "replace", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 937, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 937, "char": 35 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 938, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 940, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "command", "index-expr": [ { "type": "string", "value": "out", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 940, "char": 26 } ], "expr": { "type": "array", "left": [ { "key": { "type": "variable", "value": "method", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 941, "char": 20 }, "value": { "type": "variable", "value": "out", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 941, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 941, "char": 25 }, { "key": { "type": "string", "value": "db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 942, "char": 18 }, "value": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 942, "char": 38 }, "right": { "type": "variable", "value": "DB_MAPREDUCE", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 942, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 942, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 942, "char": 38 }, { "key": { "type": "string", "value": "sharded", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 943, "char": 23 }, "value": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 943, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 943, "char": 30 }, { "key": { "type": "string", "value": "nonAtomic", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 944, "char": 25 }, "value": { "type": "ternary", "left": { "type": "fcall", "name": "in_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "method", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 944, "char": 42 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 944, "char": 42 }, { "parameter": { "type": "array", "left": [ { "value": { "type": "string", "value": "merge", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 945, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 945, "char": 24 }, { "value": { "type": "string", "value": "reduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 13 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 14 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 14 }, { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 20 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 20 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 22 }, "right": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 947, "char": 29 }, "extra": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 948, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 948, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 948, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 948, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 948, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "rst", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 24 }, "right": { "type": "variable", "value": "_collection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 37 }, "right": { "type": "variable", "value": "db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 41 }, "name": "command", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "command", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 57 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 57 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 951, "char": 58 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 10 }, { "type": "if", "expr": { "type": "and", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "rst", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 21 }, "right": { "type": "string", "value": "ok", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 29 }, "right": { "type": "equals", "left": { "type": "array-access", "left": { "type": "variable", "value": "rst", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 34 }, "right": { "type": "string", "value": "ok", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 42 }, "right": { "type": "int", "value": "1", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 953, "char": 46 }, "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "outMongoCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 954, "char": 35 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "outMongoCollection", "expr": { "type": "new", "class": "self", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "out", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 50 }, { "parameter": { "type": "static-constant-access", "left": { "type": "variable", "value": "self", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 70 }, "right": { "type": "variable", "value": "DB_MAPREDUCE", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 70 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 70 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 70 }, { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 77 }, "right": { "type": "variable", "value": "_clusterName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 90 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 90 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 90 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 91 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 955, "char": 91 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 956, "char": 30 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "outMongoCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 956, "char": 32 }, "name": "setMongoClient", "call-type": 1, "parameters": [ { "parameter": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 956, "char": 53 }, "right": { "type": "variable", "value": "_client", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 956, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 956, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 956, "char": 61 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 956, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 957, "char": 30 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "outMongoCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 957, "char": 32 }, "name": "setNoAppendQuery", "call-type": 1, "parameters": [ { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 957, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 957, "char": 54 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 957, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 958, "char": 18 }, { "type": "return", "expr": { "type": "variable", "value": "outMongoCollection", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 958, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 959, "char": 9 } ], "else_statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 960, "char": 25 }, "name": "failure", "call-type": 1, "parameters": [ { "parameter": { "type": "int", "value": "501", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 960, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 960, "char": 37 }, { "parameter": { "type": "variable", "value": "rst", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 960, "char": 42 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 960, "char": 42 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 960, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 961, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 962, "char": 5 } ], "docblock": "**\r\n     * 执行map reduce操作,为了防止数据量过大，导致无法完成mapreduce,统一采用集合的方式，取代内存方式\r\n     * 内存方式，不允许执行过程的数据量量超过物理内存的10%，故无法进行大数量分析工作。\r\n     *\r\n     * @param array command            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 899, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "storeToGridFS", "parameters": [ { "type": "parameter", "name": "fieldName", "const": 0, "data-type": "string", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1012, "char": 52 }, { "type": "parameter", "name": "metadata", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1012, "char": 74 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1012, "char": 74 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "finfo", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1014, "char": 18 }, { "variable": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1014, "char": 23 }, { "variable": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1014, "char": 26 }, { "variable": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1014, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1015, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "metadata", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1015, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1015, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1015, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1015, "char": 32 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "metadata", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1016, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1016, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1017, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1019, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "isset", "left": { "type": "array-access", "left": { "type": "variable", "value": "_FILES", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1019, "char": 25 }, "right": { "type": "variable", "value": "fieldName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1019, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1019, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1019, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1019, "char": 37 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "_FILES[fieldName]无效", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1020, "char": 59 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1020, "char": 59 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1020, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1021, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "metadata", "expr": { "type": "fcall", "name": "array_merge", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "metadata", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 44 }, { "parameter": { "type": "array-access", "left": { "type": "variable", "value": "_FILES", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 52 }, "right": { "type": "variable", "value": "fieldName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 63 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 63 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 64 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1023, "char": 64 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1024, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "finfo", "expr": { "type": "new", "class": "\\finfo", "dynamic": 0, "parameters": [ { "parameter": { "type": "constant", "value": "FILEINFO_MIME", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1024, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1024, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1024, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1024, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "mime", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "finfo", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 26 }, "name": "file", "call-type": 1, "parameters": [ { "parameter": { "type": "array-access", "left": { "type": "array-access", "left": { "type": "variable", "value": "_FILES", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 38 }, "right": { "type": "variable", "value": "fieldName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 49 }, "right": { "type": "string", "value": "tmp_name", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 61 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 62 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1025, "char": 62 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1026, "char": 10 }, { "type": "if", "expr": { "type": "not-identical", "left": { "type": "variable", "value": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1026, "char": 19 }, "right": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1026, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1026, "char": 27 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "metadata", "index-expr": [ { "type": "string", "value": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1027, "char": 32 } ], "expr": { "type": "variable", "value": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1027, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1027, "char": 40 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1028, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1030, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1030, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1030, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "id", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 23 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 28 }, "name": "storeUpload", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "fieldName", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 50 }, { "parameter": { "type": "variable", "value": "metadata", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 60 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 60 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 61 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1031, "char": 61 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "gridfsFile", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 31 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 36 }, "name": "get", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 43 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1032, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1033, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1033, "char": 34 }, "right": { "type": "variable", "value": "\\MongoGridFSFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1033, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1033, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1033, "char": 54 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1033, "char": 54 }, "statements": [ { "type": "throw", "expr": { "type": "new", "class": "\\Exception", "dynamic": 0, "parameters": [ { "parameter": { "type": "string", "value": "gridfsFile is not instanceof MongoGridFSFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1034, "char": 80 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1034, "char": 80 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1034, "char": 81 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1035, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1037, "char": 14 }, { "type": "return", "expr": { "type": "property-access", "left": { "type": "variable", "value": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1037, "char": 27 }, "right": { "type": "variable", "value": "file", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1037, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1037, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1038, "char": 5 } ], "docblock": "**\r\n     * 云存储文件\r\n     *\r\n     * @param string fieldName\r\n     *            上传表单字段的名称\r\n     * @return array 返回上传文件成功后的object\r\n     *        \r\n     *         object结构如下:\r\n     *         array(\r\n     *         [\"_id\"] :\r\n     *         MongoId(\r\n     *        \r\n     *         id =\r\n     *         \"537cc9b54896194b228b4581\"\r\n     *         )\r\n     *         [\"collection_id\"] :\r\n     *         NULL\r\n     *         [\"name\"] :\r\n     *         \"b21c8701a18b87d624ac8e2d050828381f30fd11.jpg\"\r\n     *         [\"type\"] :\r\n     *         \"image\/jpeg\"\r\n     *         [\"tmp_name\"] :\r\n     *         \"\/tmp\/phpeBS799\"\r\n     *         [\"error\"] :\r\n     *         0\r\n     *         [\"size\"] :\r\n     *         350522\r\n     *         [\"mime\"] :\r\n     *         \"image\/jpeg; charset=binary\"\r\n     *         [\"filename\"] :\r\n     *         \"b21c8701a18b87d624ac8e2d050828381f30fd11.jpg\"\r\n     *         [\"uploadDate\"] :\r\n     *         MongoDate(\r\n     *        \r\n     *         sec =\r\n     *         1400687029\r\n     *         usec =\r\n     *         515000\r\n     *         )\r\n     *         [\"length\"] :\r\n     *         350522\r\n     *         [\"chunkSize\"] :\r\n     *         262144\r\n     *         [\"md5\"] :\r\n     *         \"3a736c4eed22030dde16df11fee263e7\"\r\n     *         )\r\n     *        \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1012, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "storeBytesToGridFS", "parameters": [ { "type": "parameter", "name": "bytes", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1047, "char": 45 }, { "type": "parameter", "name": "filename", "const": 0, "data-type": "string", "mandatory": 1, "default": { "type": "string", "value": "", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1047, "char": 68 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1047, "char": 68 }, { "type": "parameter", "name": "metadata", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1047, "char": 90 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1047, "char": 90 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "finfo", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1049, "char": 18 }, { "variable": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1049, "char": 23 }, { "variable": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1049, "char": 26 }, { "variable": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1049, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1050, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "metadata", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1050, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1050, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1050, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1050, "char": 32 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "metadata", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1051, "char": 30 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1051, "char": 30 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1052, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1054, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "empty", "left": { "type": "variable", "value": "filename", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1054, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1054, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1054, "char": 28 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "metadata", "index-expr": [ { "type": "string", "value": "filename", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1055, "char": 36 } ], "expr": { "type": "variable", "value": "filename", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1055, "char": 48 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1055, "char": 48 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1056, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1058, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "finfo", "expr": { "type": "new", "class": "\\finfo", "dynamic": 0, "parameters": [ { "parameter": { "type": "constant", "value": "FILEINFO_MIME", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1058, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1058, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1058, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1058, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1059, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "mime", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "finfo", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1059, "char": 26 }, "name": "buffer", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "bytes", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1059, "char": 39 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1059, "char": 39 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1059, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1059, "char": 40 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1060, "char": 10 }, { "type": "if", "expr": { "type": "not-identical", "left": { "type": "variable", "value": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1060, "char": 19 }, "right": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1060, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1060, "char": 27 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "array-index", "operator": "assign", "variable": "metadata", "index-expr": [ { "type": "string", "value": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1061, "char": 32 } ], "expr": { "type": "variable", "value": "mime", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1061, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1061, "char": 40 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1062, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1064, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1064, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1064, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "id", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 23 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 28 }, "name": "storeBytes", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "bytes", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 45 }, { "parameter": { "type": "variable", "value": "metadata", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 55 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 55 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 56 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1065, "char": 56 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "gridfsFile", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 31 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 36 }, "name": "get", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 43 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1066, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1067, "char": 14 }, { "type": "return", "expr": { "type": "property-access", "left": { "type": "variable", "value": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1067, "char": 27 }, "right": { "type": "variable", "value": "file", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1067, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1067, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1068, "char": 5 } ], "docblock": "**\r\n     * 存储二进制内容\r\n     *\r\n     * @param bytes bytes            \r\n     * @param string filename            \r\n     * @param array metadata            \r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1047, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "getGridFsFileById", "parameters": [ { "type": "parameter", "name": "id", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1076, "char": 41 } ], "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1078, "char": 26 }, "right": { "type": "variable", "value": "\\MongoId", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1078, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1078, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1078, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1078, "char": 38 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "id", "expr": { "type": "new", "class": "\\MongoId", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1079, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1079, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1079, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1079, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1080, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1082, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1082, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1082, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1083, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1083, "char": 21 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1083, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1083, "char": 26 }, "name": "get", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1083, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1083, "char": 33 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1083, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1084, "char": 5 } ], "docblock": "**\r\n     * 获取指定ID的GridFSFile对象\r\n     *\r\n     * @param string id            \r\n     * @return \\MongoGridFSFile object\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1076, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "getGridFsFileBy", "parameters": [ { "type": "parameter", "name": "query", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 49 }, { "type": "parameter", "name": "sort", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "array", "left": [ { "key": { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 71 }, "value": { "type": "int", "value": "-1", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 74 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 74 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 75 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 75 }, { "type": "parameter", "name": "start", "const": 0, "data-type": "int", "mandatory": 0, "default": { "type": "int", "value": "0", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 90 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 90 }, { "type": "parameter", "name": "limit", "const": 0, "data-type": "int", "mandatory": 0, "default": { "type": "int", "value": "20", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 106 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 106 }, { "type": "parameter", "name": "fields", "const": 0, "data-type": "array", "mandatory": 1, "default": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 126 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 126 } ], "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1096, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1096, "char": 27 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1096, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1096, "char": 29 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "query", "expr": { "type": "empty-array", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1097, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1097, "char": 27 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1098, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1099, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1099, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1099, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1100, "char": 11 }, { "type": "declare", "data-type": "variable", "variables": [ { "variable": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1100, "char": 19 }, { "variable": "rst", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1100, "char": 23 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "cursor", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 27 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 32 }, "name": "find", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "query", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 43 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 51 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 52 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1101, "char": 52 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1102, "char": 14 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1102, "char": 16 }, "name": "sort", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "sort", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1102, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1102, "char": 26 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1102, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1103, "char": 14 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1103, "char": 16 }, "name": "skip", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "start", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1103, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1103, "char": 27 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1103, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1104, "char": 14 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1104, "char": 16 }, "name": "limit", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "limit", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1104, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1104, "char": 28 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1104, "char": 29 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1105, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "rst", "expr": { "type": "fcall", "name": "iterator_to_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "cursor", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1105, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1105, "char": 43 }, { "parameter": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1105, "char": 50 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1105, "char": 50 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1105, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1105, "char": 51 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1106, "char": 14 }, { "type": "return", "expr": { "type": "variable", "value": "rst", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1106, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1107, "char": 5 } ], "docblock": "**\r\n     * 根据查询条件获取指定数量的结果集\r\n     *\r\n     * @param array query            \r\n     * @param number start            \r\n     * @param number limit            \r\n     * @return multitype:\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1094, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "getGridFS", "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1116, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1116, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1117, "char": 14 }, { "type": "return", "expr": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1117, "char": 21 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1117, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1117, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1118, "char": 5 } ], "docblock": "**\r\n     * 获取GridFS对象\r\n     *\r\n     * @return \\MongoGridFS\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1114, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "getInfoFromGridFS", "parameters": [ { "type": "parameter", "name": "id", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1126, "char": 41 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1128, "char": 23 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1129, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1129, "char": 26 }, "right": { "type": "variable", "value": "\\MongoId", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1129, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1129, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1129, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1129, "char": 38 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "id", "expr": { "type": "new", "class": "\\MongoId", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1130, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1130, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1130, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1130, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1131, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1132, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1132, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1132, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "gridfsFile", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 31 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 36 }, "name": "get", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 43 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1133, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1134, "char": 14 }, { "type": "return", "expr": { "type": "property-access", "left": { "type": "variable", "value": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1134, "char": 27 }, "right": { "type": "variable", "value": "file", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1134, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1134, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1135, "char": 5 } ], "docblock": "**\r\n     * 根据ID获取文件的信息\r\n     *\r\n     * @param string id            \r\n     * @return array 文件信息数组\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1126, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "getFileFromGridFS", "parameters": [ { "type": "parameter", "name": "id", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1143, "char": 41 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1145, "char": 23 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1146, "char": 10 }, { "type": "if", "expr": { "type": "not", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1146, "char": 26 }, "right": { "type": "variable", "value": "\\MongoId", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1146, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1146, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1146, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1146, "char": 38 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "id", "expr": { "type": "new", "class": "\\MongoId", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1147, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1147, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1147, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1147, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1148, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1149, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1149, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1149, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 11 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "gridfsFile", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 31 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 36 }, "name": "get", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 43 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 43 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 44 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1150, "char": 44 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1151, "char": 10 }, { "type": "if", "expr": { "type": "instanceof", "left": { "type": "variable", "value": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1151, "char": 32 }, "right": { "type": "variable", "value": "\\MongoGridFSFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1151, "char": 51 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1151, "char": 51 }, "statements": [ { "type": "return", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "gridfsFile", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1152, "char": 31 }, "name": "getBytes", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1152, "char": 42 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1153, "char": 9 } ], "else_statements": [ { "type": "return", "expr": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1154, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1155, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1156, "char": 5 } ], "docblock": "**\r\n     * 根据ID获取文件内容，二进制\r\n     *\r\n     * @param string id            \r\n     * @return bytes\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1143, "char": 19 }, { "visibility": [ "public" ], "type": "method", "name": "removeFileFromGridFS", "parameters": [ { "type": "parameter", "name": "id", "const": 0, "data-type": "variable", "mandatory": 0, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1165, "char": 44 } ], "statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "list", "left": { "type": "instanceof", "left": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1167, "char": 26 }, "right": { "type": "variable", "value": "\\MongoId", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1167, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1167, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1167, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1167, "char": 38 }, "statements": [ { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "id", "expr": { "type": "new", "class": "\\MongoId", "dynamic": 0, "parameters": [ { "parameter": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1168, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1168, "char": 37 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1168, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1168, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1169, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1170, "char": 12 }, { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1170, "char": 14 }, "name": "initGridFS", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1170, "char": 27 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1171, "char": 14 }, { "type": "return", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1171, "char": 21 }, "right": { "type": "variable", "value": "_fs", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1171, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1171, "char": 26 }, "name": "remove", "call-type": 1, "parameters": [ { "parameter": { "type": "array", "left": [ { "key": { "type": "string", "value": "_id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1172, "char": 19 }, "value": { "type": "variable", "value": "id", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1173, "char": 9 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1173, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1173, "char": 10 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1173, "char": 10 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1173, "char": 11 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1174, "char": 5 } ], "docblock": "**\r\n     * 删除陈旧的文件\r\n     *\r\n     * @param mixed id\r\n     *            \\MongoID or String\r\n     * @return bool true or false\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1165, "char": 19 }, { "visibility": [ "private" ], "type": "method", "name": "array_unset_recursive", "parameters": [ { "type": "parameter", "name": "arr", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1177, "char": 54 }, { "type": "parameter", "name": "fields", "const": 0, "data-type": "array", "mandatory": 1, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1177, "char": 69 }, { "type": "parameter", "name": "remove", "const": 0, "data-type": "bool", "mandatory": 0, "default": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1177, "char": 92 }, "reference": 0, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1177, "char": 92 } ], "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1179, "char": 16 }, { "variable": "value", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1179, "char": 22 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1180, "char": 11 }, { "type": "for", "expr": { "type": "variable", "value": "arr", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1180, "char": 30 }, "key": "key", "value": "value", "reverse": 0, "statements": [ { "type": "if", "expr": { "type": "variable", "value": "remove", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1181, "char": 23 }, "statements": [ { "type": "if", "expr": { "type": "fcall", "name": "in_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1182, "char": 32 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1182, "char": 32 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1182, "char": 40 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1182, "char": 40 }, { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1182, "char": 46 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1182, "char": 46 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1182, "char": 48 }, "statements": [ { "type": "unset", "expr": { "type": "list", "left": { "type": "array-access", "left": { "type": "variable", "value": "arr", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1183, "char": 30 }, "right": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1183, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1183, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1183, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1184, "char": 17 } ], "else_statements": [ { "type": "if", "expr": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "value", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1185, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1185, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1185, "char": 40 }, "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 30 }, "name": "array_unset_recursive", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "value", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 58 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 66 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 66 }, { "parameter": { "type": "variable", "value": "remove", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 74 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 74 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1186, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1187, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1188, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1189, "char": 13 } ], "else_statements": [ { "type": "if", "expr": { "type": "not", "left": { "type": "fcall", "name": "in_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 33 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 41 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 41 }, { "parameter": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 47 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 47 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 49 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1190, "char": 49 }, "statements": [ { "type": "unset", "expr": { "type": "list", "left": { "type": "array-access", "left": { "type": "variable", "value": "arr", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1191, "char": 30 }, "right": { "type": "variable", "value": "key", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1191, "char": 34 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1191, "char": 35 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1191, "char": 36 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1192, "char": 17 } ], "else_statements": [ { "type": "if", "expr": { "type": "fcall", "name": "is_array", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "value", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1193, "char": 38 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1193, "char": 38 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1193, "char": 40 }, "statements": [ { "type": "mcall", "expr": { "type": "mcall", "variable": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 30 }, "name": "array_unset_recursive", "call-type": 1, "parameters": [ { "parameter": { "type": "variable", "value": "value", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 58 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 58 }, { "parameter": { "type": "variable", "value": "fields", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 66 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 66 }, { "parameter": { "type": "variable", "value": "remove", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 74 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 74 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1194, "char": 75 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1195, "char": 21 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1196, "char": 17 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1197, "char": 13 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1198, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1200, "char": 14 }, { "type": "return", "expr": { "type": "variable", "value": "arr", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1200, "char": 19 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1201, "char": 5 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1177, "char": 20 }, { "visibility": [ "private" ], "type": "method", "name": "debug", "statements": [ { "type": "if", "expr": { "type": "instanceof", "left": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1209, "char": 17 }, "right": { "type": "variable", "value": "_db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1209, "char": 31 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1209, "char": 31 }, "right": { "type": "variable", "value": "\\MongoDB", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1209, "char": 42 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1209, "char": 42 }, "statements": [ { "type": "declare", "data-type": "variable", "variables": [ { "variable": "err", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1210, "char": 20 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1211, "char": 15 }, { "type": "let", "assignments": [ { "assign-type": "variable", "operator": "assign", "variable": "err", "expr": { "type": "mcall", "variable": { "type": "property-access", "left": { "type": "variable", "value": "this", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1211, "char": 28 }, "right": { "type": "variable", "value": "_db", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1211, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1211, "char": 33 }, "name": "lastError", "call-type": 1, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1211, "char": 45 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1211, "char": 45 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1213, "char": 18 }, { "type": "return", "expr": { "type": "variable", "value": "err", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1213, "char": 23 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1214, "char": 9 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1215, "char": 5 } ], "docblock": "**\r\n     * 打印最后一个错误信息\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1207, "char": 20 }, { "visibility": [ "public" ], "type": "method", "name": "__destruct", "docblock": "**\r\n     * 在析构函数中调用debug方法\r\n     *", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 1220, "char": 19 } ], "constants": [ { "type": "const", "name": "TIMEOUT", "default": { "type": "int", "value": "6000000", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 69, "char": 28 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 71, "char": 9 }, { "type": "const", "name": "FSYNC", "default": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 71, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 73, "char": 9 }, { "type": "const", "name": "UPSERT", "default": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 73, "char": 25 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 75, "char": 9 }, { "type": "const", "name": "MULTIPLE", "default": { "type": "bool", "value": "true", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 75, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 77, "char": 9 }, { "type": "const", "name": "JUSTONE", "default": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 77, "char": 26 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 79, "char": 9 }, { "type": "const", "name": "DEBUG", "default": { "type": "bool", "value": "false", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 79, "char": 24 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 81, "char": 9 }, { "type": "const", "name": "GRIDFS_PREFIX", "default": { "type": "string", "value": "icc_", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 81, "char": 33 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 83, "char": 9 }, { "type": "const", "name": "DB_MAPREDUCE", "default": { "type": "string", "value": "mapreduce", "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 83, "char": 37 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 86, "char": 7 } ], "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 3, "char": 5 }, "file": "\/vagrant\/zephir_code\/my\/my\/mongo\/collection.zep", "line": 3, "char": 5 } ]
